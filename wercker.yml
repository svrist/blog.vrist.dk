box: google/golang
build:
  steps:
    - install-packages:
        packages: mercurial openssh-client
    - add-to-known_hosts:
        hostname: github.com
    - script:
        name: initialize git submodules
        code: |
            cd $WERCKER_SOURCE_DIR
            git submodule update --init --recursive
    - arjen/hugo-build:
        version: "HEAD"
        theme: hugo-uno
        flags: --buildDrafts=true
deploy:
  steps:
    - install-packages:
        packages: lftp
    - script:
        name: sftp files to host
        code: |
            cd $WERCKER_SOURCE_DIR
            echo "open sftp://$USER:$SSHPASS@$HOST && mirror -R public/ $DIR"
            /usr/bin/lftp -c "open sftp://$USER:$SSHPASS@$HOST && mirror -R public/ $DIR"
